---
title: APMメトリックアラート条件
tags:
  - Alerts and Applied Intelligence
  - New Relic Alerts
  - Alert conditions
metaDescription: How to create an APM metric alert condition using NRQL.
---

APM メトリックのアラート条件を作成するには、さまざまな方法がありますが、NRQL を使用することをお勧めします。NRQL を使用すると、追加の制御が可能になり、検出時間が短縮され、すべてのデータタイプに対して一貫性を維持できます。

2021 年に、New Relic One 全体でチャートとクエリから NRQL アラート条件をより簡単に作成できるようになりました。NRQL を使用して APM の外部サービス条件を作成する方法例については、下を参照してください。

APM メトリック条件の設定は 2 つのプロセスからなります。最初に、エンティティを識別してから、NRQL 条件を作成する必要があります。

## エンティティの識別 [#identify]

次のように作業を開始します。

1. [one.newrelic.com](https://one.newrelic.com)へ移動し、ツールバーの**APM**をクリックします。

2. アラートを作成するサービスを探します。

3. サービスをクリックします。

4. 左のナビゲーションペインで、\[**External services（外部サービス）**]をクリックします。

5. \[**}Top 20 external services（トップ 20 外部サービス）**]で、目的のサービスを見つけてクリックします。

   ![選択できるトップ20の外部サービスのリストを示す画面キャプチャ。](src/images/top-twenty-2.png 'top-twenty.png')

6. ページの右側には、**Response time（レスポンスタイム）**]と\[**External calls per minute（毎分の外部呼び出し数）**（スループット）のグラフがあります。この 2 つのオプションからアラートを作成するオプションを選択します。

7. 選択するグラフの右上隅で、3 つのドットをクリックし、\[**Create alert condition（アラート条件の作成）**]を選択します。

   <Callout variant="tip">
     3つのドットが表示されない場合は、ページの最上部にある\[**Show new
     view（新しいビューを表示）**]オプションが有効になっていることを確認します。
   </Callout>

   ![メニューのオプションを示すスクリーンショット。](src/images/external_service_graph_2.png 'external_service_graph.png')

8. これによって NRQL アラート条件ビルダでモードが起動され、クエリが事前入力されます。

   - レスポンスタイムを選択すると、クエリは次のようになります。

     ![レスポンスタイムのクエリを示す例。](src/images/response_time_query.png 'response_time_query.png')

   - 毎分の外部呼び出し数を選択すると、クエリは次のようになります。

     ![外部呼び出しのクエリを示す例。](src/images/external-calls-query.png 'external-calls-query.png')

条件ビルダにクエリが事前入力されていると、次のセクションへ続行し、NRQL アラート条件が作成されます。

## NRQL アラート条件を作成する [#nrql-condition]

モーダルで、以下を完了させます。

1. 条件名を入力します。

2. **信号の定義**で、`LIMIT`、`SINCE...AGO`、および`TIMESERIES`句が削除され、NRQL クエリ構文が有効であることを観察します。

   <Callout variant="tip">
     結果が返されない場合は、モーダルの左上隅の現在のアカウントを見て、正しいアカウントであることを確認します。正しくない場合は、モーダルをクローズし、ページ左上隅のアカウントピッカーで正しいアカウントが選択されていることをダブルチェックします。
   </Callout>

   ![クエリで事前入力されたNRQLアラート条件ビルダを示すスクリーンショット。](src/images/nrql_condition_builder_modal.png 'nrql_condition_builder_modal.png')

3. 残りのフィールドに入力し、フォームの下部近くでポリシーを選択または作成して、条件を保存します。

NRQL を使用して APM メトリックタイムスライスのデータにクエリを実行する方法については、[追加情報](/docs/query-your-data/nrql-new-relic-query-language/nrql-query-tutorials/query-apm-metric-timeslice-data-nrql#timeslice-conversion)をご覧ください。
