---
title: APMメトリックアラート条件
tags:
  - Alerts and Applied Intelligence
  - New Relic Alerts
  - Alert conditions
metaDescription: How to create an APM metric alert condition using NRQL.
---

import topTwenty2 from 'images/top-twenty-2.png'

import externalServiceGraph2 from 'images/external_service_graph_2.png'

import responseTimeQuery from 'images/response_time_query.png'

import externalCallsQuery from 'images/external-calls-query.png'

import nrqlConditionBuilderModal from 'images/nrql_condition_builder_modal.png'

APMメトリックのアラート条件を作成するには、さまざまな方法がありますが、NRQLを使用することをお勧めします。NRQLを使用すると、追加の制御が可能になり、検出時間が短縮され、すべてのデータタイプに対して一貫性を維持できます。

2021年に、New Relic One全体でチャートとクエリからNRQLアラート条件をより簡単に作成できるようになりました。NRQLを使用してAPMの外部サービス条件を作成する方法例については、下を参照してください。

APMメトリック条件の設定は2つのプロセスからなります。最初に、エンティティを識別してから、NRQL条件を作成する必要があります。

## エンティティの識別 [#identify]

次のように作業を開始します。

1. [one.newrelic.com](https://one.newrelic.com)へ移動し、ツールバーの**APM**をクリックします。

2. アラートを作成するサービスを探します。

3. サービスをクリックします。

4. 左のナビゲーションペインで、\[**External services（外部サービス）**]をクリックします。

5. \[**}Top 20 external services（トップ20外部サービス）**]で、目的のサービスを見つけてクリックします。

   <img
     src={topTwenty2}
     title="top-twenty.png"
     alt="選択できるトップ20の外部サービスのリストを示す画面キャプチャ。"
   />

6. ページの右側には、**Response time（レスポンスタイム）**]と\[**External calls per minute（毎分の外部呼び出し数）**（スループット）のグラフがあります。この2つのオプションからアラートを作成するオプションを選択します。

7. 選択するグラフの右上隅で、3つのドットをクリックし、\[**Create alert condition（アラート条件の作成）**]を選択します。

   <Callout variant="tip">
     3つのドットが表示されない場合は、ページの最上部にある\[**Show new view（新しいビューを表示）**]オプションが有効になっていることを確認します。
   </Callout>

   <img
     src={externalServiceGraph2}
     title="external_service_graph.png"
     alt="メニューのオプションを示すスクリーンショット。"
   />

8. これによってNRQLアラート条件ビルダでモードが起動され、クエリが事前入力されます。

   * レスポンスタイムを選択すると、クエリは次のようになります。

     <img
       src={responseTimeQuery}
       title="response_time_query.png"
       alt="レスポンスタイムのクエリを示す例。"
     />

   * 毎分の外部呼び出し数を選択すると、クエリは次のようになります。

     <img
       src={externalCallsQuery}
       title="external-calls-query.png"
       alt="外部呼び出しのクエリを示す例。"
     />

条件ビルダにクエリが事前入力されていると、次のセクションへ続行し、NRQLアラート条件が作成されます。

## NRQLアラート条件を作成する [#nrql-condition]

モーダルで、以下を完了させます。

1. 条件名を入力します。

2. **信号の定義**で、`LIMIT`、`SINCE...AGO`、および`TIMESERIES`句が削除され、NRQLクエリ構文が有効であることを観察します。

   <Callout variant="tip">
     結果が返されない場合は、モーダルの左上隅の現在のアカウントを見て、正しいアカウントであることを確認します。正しくない場合は、モーダルをクローズし、ページ左上隅のアカウントピッカーで正しいアカウントが選択されていることをダブルチェックします。
   </Callout>

   <img
     src={nrqlConditionBuilderModal}
     title="nrql_condition_builder_modal.png"
     alt="クエリで事前入力されたNRQLアラート条件ビルダを示すスクリーンショット。"
   />

3. 残りのフィールドに入力し、フォームの下部近くでポリシーを選択または作成して、条件を保存します。

NRQLを使用してAPMメトリックタイムスライスのデータにクエリを実行する方法については、[追加情報](/docs/query-your-data/nrql-new-relic-query-language/nrql-query-tutorials/query-apm-metric-timeslice-data-nrql#timeslice-conversion)をご覧ください。
